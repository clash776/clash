<!DOCTYPE html>
<html lang="ja">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ボタンを使ってみよう</title>
  <script type="module" crossorigin src="/my-app/assets/main1-DKnhThjR.js"></script>
  <link rel="stylesheet" crossorigin href="/my-app/assets/main1-C9ua35nR.css">
</head>

<body>
  <div class="main-layout">
    <div class="sidebar">
      <nav
        style="display: flex; position:absolute; top: 200px; flex-direction: column; align-items: center; gap: 16px;">
        <to-chapter-howtouse></to-chapter-howtouse>
        <to-chapter-1></to-chapter-1>
        <to-chapter-2></to-chapter-2>
        <a href="#" style="color: #fff;text-decoration: none; font-weight: bold;font-size: 25px;">3章<br>複雑なLED機器の制御</a>
        <div class="sidebar-links" style="background: #1976d2; border-radius: 10px; padding: 8px 0; width: 240px;">
          <a href="#" class="page-link" data-to="page1" data-editor="#editor1" data-run="run-button1"
            data-stop="stop-button1" data-status="status-label1" data-compiler="compiler-output-text1"
            data-error="error-output-text1"
            style="color: #fff; text-decoration: none; font-weight: bold; display: block; padding: 6px 16px; border-radius: 6px;">3-1:
            7セグメントLED</a>
          <a href="#" class="page-link" data-to="page2" data-editor="#editor1" data-run="run-button1"
            data-stop="stop-button1" data-status="status-label1" data-compiler="compiler-output-text1"
            data-error="error-output-text1"
            style="color: #fff; text-decoration: none; font-weight: bold; display: block; padding: 6px 16px; border-radius: 6px;">3-2:
            7セグメントLEDの概要</a>
          <a href="#" class="page-link" data-to="page3" data-editor="#editor2" data-run="run-button2"
            data-stop="stop-button2" data-status="status-label2" data-compiler="compiler-output-text2"
            data-error="error-output-text2"
            style="color: #fff; text-decoration: none; font-weight: bold; display: block; padding: 6px 16px; border-radius: 6px;">3-3:
            練習問題</a>
          <a href="#" class="page-link" data-to="pageTest" data-editor="#editor3" data-run="run-button3"
            data-stop="stop-button3" data-status="status-label3" data-compiler="compiler-output-text3"
            data-error="error-output-text3"
            style="color: #fff; text-decoration: none; font-weight: bold; display: block; padding: 6px 16px; border-radius: 6px;">3-4:
            確認問題</a>
          <a href="#" class="page-link" data-to="pageOmake" data-editor="#editor4" data-run="run-button4"
            data-stop="stop-button4" data-status="status-label4" data-compiler="compiler-output-text4"
            data-error="error-output-text4"
            style="color: #fff; text-decoration: none; font-weight: bold; display: block; padding: 6px 16px; border-radius: 6px;">3-5:
            おまけ</a>
          <a href="#" class="page-link" data-to="pageOmake2" data-editor="#editor5" data-run="run-button5"
            data-stop="stop-button5" data-status="status-label5" data-compiler="compiler-output-text5"
            data-error="error-output-text5"
            style="color: #fff; text-decoration: none; font-weight: bold; display: block; padding: 6px 16px; border-radius: 6px;">3-6:
            おまけ2</a>
        </div>
        <to-chapter-4></to-chapter-4>
        <to-chapter-5></to-chapter-5>
        <to-chapter-6></to-chapter-6>
        <to-test-1></to-test-1>
        <to-final></to-final>
      </nav>
    </div>
    <div class="main-content">
      <div id="page1" style="display:block;">
        <h2>第3章　複雑なLED機器の制御</h2>
        <p>この章では<b style="color:#1976d2;">7セグメントLED</b>の使い方について学びます。</p>
        <div class="blue-point-box">
          <p>7セグメントLEDは複数のLEDを組み合わせて数字や文字を表示できる部品です。</p>
          <h3><b>7セグメントLED</b></h3>
          <div
            style="position: relative; display: flex; justify-content: center; align-items: center; width: 500px; height: 180px; margin: 0 auto;">
            <wokwi-7segment color="red" values="[0,0,0,0,0,0,0,0]" pins="extend"
              style="transform: scale(2.2, 1.88); margin: 0 auto;"></wokwi-7segment>
          </div>
        </div>
        <p style="margin-bottom:8px;">まずは、プログラムを動作させてみましょう。</p>
        <div class="app-container">
          <!-- wokwiオブジェクト部分はそのまま -->
          <div class="leds-circuit" style="position: relative; width: 500px; height: 500px; margin: 0 auto;">
            <my-breadboard style="display:block; position:absolute; top:0px; left:0px;"></my-breadboard>
            <!-- LEDを中央上に配置 -->
            <wokwi-7segment id="segment" color="red" values="[0,0,0,0,0,0,0,0]" pins="extend"
              style="position: absolute; left: 269px; top: 111px; transform: scale(1.56, 1.28);"></wokwi-7segment>
            <!-- Arduino Unoを中央下に配置 -->
            <wokwi-resistor value="200" style="position: absolute; left: 308px; top: 219px;"></wokwi-resistor>
            <wokwi-resistor value="200"
              style="position: absolute; left: 225px; top: 203px; transform: rotate(212deg);"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 203px; top: 219px;"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 308px; top: 79px;"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 323px; top: 64px;"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 218px; top: 79px;"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 203px; top: 64px;"></wokwi-resistor>


            <wokwi-arduino-uno id="circuit-arduino"
              style="position: absolute; left: 110px; top: 300px;"></wokwi-arduino-uno>
            <!-- 回路の線をSVGで描画（LEDの足からArduinoの7番ピン/GNDへ） -->
            <svg width="500" height="340" style="position: absolute; left: 0; top: 0;">
              <!-- 2番ピンへ -->
              <line x1="367" y1="99" x2="405" y2="99" stroke="red" stroke-width="3" />
              <line x1="403" y1="99" x2="403" y2="300" stroke="red" stroke-width="3" />
              <line x1="403" y1="299" x2="360" y2="299" stroke="red" stroke-width="3" />
              <line x1="360" y1="299" x2="345" y2="310" stroke="red" stroke-width="3" />
              <!-- 3番ピンへ -->
              <line x1="381" y1="84" x2="420" y2="84" stroke="red" stroke-width="3" />
              <line x1="418" y1="84" x2="418" y2="295" stroke="red" stroke-width="3" />
              <line x1="418" y1="293" x2="406" y2="293" stroke="red" stroke-width="3" />
              <line x1="400" y1="293" x2="360" y2="293" stroke="red" stroke-width="3" />
              <line x1="360" y1="293" x2="335" y2="310" stroke="red" stroke-width="3" />
              <!-- 4番ピンへ -->
              <line x1="368" y1="209" x2="392" y2="209" stroke="red" stroke-width="3" />
              <line x1="390" y1="209" x2="390" y2="286" stroke="red" stroke-width="3" />
              <line x1="392" y1="286" x2="360" y2="286" stroke="red" stroke-width="3" />
              <line x1="360" y1="286" x2="325" y2="310" stroke="red" stroke-width="3" />
              <!-- 5番ピンへ -->
              <line x1="233" y1="179" x2="225" y2="179" stroke="red" stroke-width="3" />
              <line x1="227" y1="179" x2="227" y2="218" stroke="red" stroke-width="3" />
              <line x1="227" y1="231" x2="227" y2="240" stroke="red" stroke-width="3" />
              <line x1="225" y1="240" x2="320" y2="240" stroke="red" stroke-width="3" />
              <line x1="318" y1="240" x2="318" y2="310" stroke="red" stroke-width="3" />
              <!-- 6番ピンへ -->
              <line x1="203" y1="209" x2="193" y2="209" stroke="red" stroke-width="3" />
              <line x1="195" y1="209" x2="195" y2="260" stroke="red" stroke-width="3" />
              <line x1="193" y1="260" x2="310" y2="260" stroke="red" stroke-width="3" />
              <line x1="308" y1="260" x2="308" y2="310" stroke="red" stroke-width="3" />
              <!-- 7番ピンへ -->
              <line x1="218" y1="99" x2="180" y2="99" stroke="red" stroke-width="3" />
              <line x1="182" y1="99" x2="182" y2="270" stroke="red" stroke-width="3" />
              <line x1="180" y1="270" x2="300" y2="270" stroke="red" stroke-width="3" />
              <line x1="298" y1="270" x2="298" y2="310" stroke="red" stroke-width="3" />
              <!-- 8番ピンへ -->
              <line x1="203" y1="84" x2="165" y2="84" stroke="red" stroke-width="3" />
              <line x1="167" y1="84" x2="167" y2="280" stroke="red" stroke-width="3" />
              <line x1="165" y1="280" x2="286" y2="280" stroke="red" stroke-width="3" />
              <line x1="284" y1="280" x2="284" y2="310" stroke="red" stroke-width="3" />
              <!-- GNDへ -->
              <line x1="292" y1="84" x2="292" y2="40" stroke="black" stroke-width="3" />
              <line x1="292" y1="40" x2="150" y2="40" stroke="black" stroke-width="3" />
              <line x1="152" y1="40" x2="152" y2="295" stroke="black" stroke-width="3" />
              <line x1="150" y1="295" x2="228" y2="295" stroke="black" stroke-width="3" />
              <line x1="226" y1="295" x2="225" y2="310" stroke="black" stroke-width="3" />
            </svg>
          </div>
          <p></p>
          <div class="toolbar">
            <button id="run-button1">Run</button>
            <button id="stop-button1" disabled>Stop</button>
            <div class="spacer"></div>
            <div id="status-label1"></div>
          </div>
          <div class="code-editor" id="editor1"></div>
          <div class="compiler-output">
            <pre id="compiler-output-text1"></pre>
          </div>
          <div class="error-output">
            <pre id="error-output-text1"></pre>
          </div>
        </div>
        <p>プログラムを実行すると、7セグメントLEDが点灯し、数字の8が表示されているように見えると思います。</p>
        <p><span style="font-size:1.1em; background:#d9fdd9; padding:2px 6px; border-radius:4px;">
            <b style="color:#1976d2;">7セグメントLEDは点灯のさせ方によって、数字やアルファベットを表示させることが出来ます。</b></span></p>
        <p>次のページでは、7セグメントLEDの仕組みについて学びます。</p>

        <button class="page-nav" data-to="page2" data-editor="#editor1" data-run="run-button1" data-stop="stop-button1"
          data-status="status-label1" data-compiler="compiler-output-text1" data-error="error-output-text1"
          onclick="markPageReached(1);">次のページへ</button>
      </div>
      <div id="page2" style="display:none;">
        <p></p>
        <div class="blue-point-box">
          <h3 style="margin-bottom:8px;">7セグメントLEDの概要</h3>
          <ul style="margin-bottom:16px;">
            <li>7セグメントLEDは、<span style="font-size:1.1em; background:#d9fdd9; padding:2px 6px; border-radius:4px;">
                <b
                  style="color:#1976d2;">7つの棒状LED（セグメント）と1つの小さな点（ドット）の計8個のLED</b></span>で構成されています。<br><b>(本教材の問題ではドット部分は使用しません)</b>
            </li>
            <li>各LEDは<b style="color:#1976d2;">対応するピンに電流を流す</b>ことで点灯します。</li>
            <li>LEDとピンの対応は下の画像の通りとなっています。</li>
          </ul>
          <div
            style="position: relative; display: flex; justify-content: center; align-items: center; width: 500px; height: 250px; margin: 0 auto;">
            <wokwi-7segment color="red" values="[0,0,0,0,0,0,0,0]" pins="extend"
              style="transform: scale(2.2, 1.88); margin: 0 60px;"></wokwi-7segment>
            <wokwi-7segment color="red" values="[0,0,0,0,0,0,0,0]" pins="extend"
              style="transform: scale(2.2, 1.88); margin: 0 60px;"></wokwi-7segment>
            <svg width="500" height="250" style="position: absolute; left: 0; top: 0;">
              <!-- LED番号のテキスト -->
              <text x="165" y="70" font-size="20" font-weight="bold" fill="red">1</text>
              <text x="195" y="105" font-size="20" font-weight="bold" fill="red">2</text>
              <text x="190" y="150" font-size="20" font-weight="bold" fill="red">3</text>
              <text x="150" y="185" font-size="20" font-weight="bold" fill="red">4</text>
              <text x="115" y="150" font-size="20" font-weight="bold" fill="red">5</text>
              <text x="120" y="105" font-size="20" font-weight="bold" fill="red">6</text>
              <text x="155" y="125" font-size="20" font-weight="bold" fill="red">7</text>
              <text x="200" y="185" font-size="20" font-weight="bold" fill="red">8</text>
              <!-- ピン番号のテキスト -->
              <text x="348" y="30" font-size="20" font-weight="bold" fill="red">1</text>
              <text x="370" y="30" font-size="20" font-weight="bold" fill="red">2</text>
              <text x="348" y="220" font-size="20" font-weight="bold" fill="red">3</text>
              <text x="306" y="220" font-size="20" font-weight="bold" fill="red">4</text>
              <text x="285" y="220" font-size="20" font-weight="bold" fill="red">5</text>
              <text x="306" y="30" font-size="20" font-weight="bold" fill="red">6</text>
              <text x="285" y="30" font-size="20" font-weight="bold" fill="red">7</text>
              <text x="370" y="220" font-size="20" font-weight="bold" fill="red">8</text>
            </svg>
          </div>
          <p><span style="font-size:1.1em; background:#d9fdd9; padding:2px 6px; border-radius:4px;">
              <b>ポイント：</b>左の画像の数字の位置のLEDが右の画像のピンに対応しています。</span></p>
        </div>
        <p></p>
        <div class="green-point-box">
          <h3 style="margin-bottom:8px;">7セグメントLEDの内部回路</h3>
          <ul style="margin-bottom:16px;">
            <li>中心のピンは<b style="color:#388e3c;">共通端子</b>と呼ばれ、LEDのアノード側またはカソード側がまとめられています。</li>
            <li>カソード側が集められているものを<b style="color:#388e3c;">カソードコモン型</b>、アノード側が集められているものを<b
                style="color:#388e3c;">アノードコモン型</b>と呼びます。</li>
            <li>本教材ではカソードコモン型を使用します。</li>
          </ul>
          <div
            style="position: relative; display: flex; justify-content: center; align-items: center; width: 500px; height: 250px; margin: 0 auto;">
            <wokwi-7segment color="red" values="[0,0,0,0,0,0,0,0]" pins="extend"
              style="transform: scale(2.2, 1.88); margin: 0 auto;"></wokwi-7segment>
            <svg width="500" height="250" style="position: absolute; left: 0; top: 0;">
              <text x="230" y="30" font-size="20" font-weight="bold" fill="red">com</text>
              <text x="230" y="220" font-size="20" font-weight="bold" fill="red">com</text>
            </svg>
          </div>
          <p><span style="font-size:1.1em; background:#e3f2fd; padding:2px 6px; border-radius:4px;">
              <b>補足:</b>Arduinoでカソードコモン型の7セグメントLEDを制御する場合、<br>アノード側のピン（1～8）を出力ピンに接続し、共通ピンはGNDに接続します。</span></p>
        </div>
        <p></p>
        <button class="page-nav" data-to="page1" data-editor="#editor1" data-run="run-button1" data-stop="stop-button1"
          data-status="status-label1" data-compiler="compiler-output-text1"
          data-error="error-output-text1">前のページへ</button>
        <button class="page-nav" data-to="page3" data-editor="#editor2" data-run="run-button2" data-stop="stop-button2"
          data-status="status-label2" data-compiler="compiler-output-text2" data-error="error-output-text2"
          onclick="markPageReached(2);">次のページへ</button>
      </div>
      <div id="page3" style="display:none;">
        <h2>練習問題</h2>
        <p>それでは下の画像をもとにエディタ内のプログラムを編集してみましょう</p>
        <p>回路図を見て対応するピンの出力をHIGHにし、数字の5のLEDが点灯するようにしてみましょう</p>
        <div
          style="display: flex; justify-content: center; gap: 16px; border: 2px solid black; padding: 12px; border-radius: 8px; width: fit-content; margin: 0 auto; margin-bottom: 32px;">
          <div
            style="position: relative; display: flex; justify-content: center; align-items: center; width: 500px; height: 250px; margin: 0 auto;">
            <wokwi-7segment color="red" values="[0,0,0,0,0,0,0,0]" pins="extend"
              style="transform: scale(2.2, 1.88); margin: 0 60px;"></wokwi-7segment>
            <wokwi-7segment color="red" values="[0,0,0,0,0,0,0,0]" pins="extend"
              style="transform: scale(2.2, 1.88); margin: 0 60px;"></wokwi-7segment>
            <svg width="500" height="250" style="position: absolute; left: 0; top: 0;">
              <!-- LED番号のテキスト -->
              <text x="165" y="70" font-size="20" font-weight="bold" fill="red">1</text>
              <text x="195" y="105" font-size="20" font-weight="bold" fill="red">2</text>
              <text x="190" y="150" font-size="20" font-weight="bold" fill="red">3</text>
              <text x="150" y="185" font-size="20" font-weight="bold" fill="red">4</text>
              <text x="115" y="150" font-size="20" font-weight="bold" fill="red">5</text>
              <text x="120" y="105" font-size="20" font-weight="bold" fill="red">6</text>
              <text x="155" y="125" font-size="20" font-weight="bold" fill="red">7</text>
              <text x="200" y="185" font-size="20" font-weight="bold" fill="red">8</text>
              <!-- ピン番号のテキスト -->
              <text x="348" y="30" font-size="20" font-weight="bold" fill="red">1</text>
              <text x="370" y="30" font-size="20" font-weight="bold" fill="red">2</text>
              <text x="348" y="220" font-size="20" font-weight="bold" fill="red">3</text>
              <text x="306" y="220" font-size="20" font-weight="bold" fill="red">4</text>
              <text x="285" y="220" font-size="20" font-weight="bold" fill="red">5</text>
              <text x="306" y="30" font-size="20" font-weight="bold" fill="red">6</text>
              <text x="285" y="30" font-size="20" font-weight="bold" fill="red">7</text>
              <text x="370" y="220" font-size="20" font-weight="bold" fill="red">8</text>
            </svg>
          </div>
        </div>
        <div
          style="position: relative; display: flex; justify-content: center; align-items: center; width: 500px; height: 230px; margin: 0 auto;">
          <wokwi-7segment color="red" values="[1,0,1,1,0,1,1,0]" pins="extend"
            style="transform: scale(2.2, 1.88); margin: 0 auto;"></wokwi-7segment>
          <svg width="500" height="220" style="position: absolute; left: 0; top: 0;">
            <text x="230" y="20" font-size="20" font-weight="bold" fill="black">目標</text>
          </svg>
        </div>
        <div class="app-container">
          <div class="leds-circuit" style="position: relative; width: 500px; height: 500px; margin: 0 auto;">
            <my-breadboard style="display:block; position:absolute; top:0px; left:0px;"></my-breadboard>
            <!-- LEDを中央上に配置 -->
            <wokwi-7segment id="segment" color="red" values="[0,0,0,0,0,0,0,0]" pins="extend"
              style="position: absolute; left: 269px; top: 111px; transform: scale(1.56, 1.28);"></wokwi-7segment>
            <!-- Arduino Unoを中央下に配置 -->
            <wokwi-resistor value="200" style="position: absolute; left: 308px; top: 219px;"></wokwi-resistor>
            <wokwi-resistor value="200"
              style="position: absolute; left: 225px; top: 203px; transform: rotate(212deg);"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 203px; top: 219px;"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 308px; top: 79px;"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 323px; top: 64px;"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 218px; top: 79px;"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 203px; top: 64px;"></wokwi-resistor>


            <wokwi-arduino-uno id="circuit-arduino"
              style="position: absolute; left: 110px; top: 300px;"></wokwi-arduino-uno>
            <!-- 回路の線をSVGで描画（LEDの足からArduinoの7番ピン/GNDへ） -->
            <svg width="500" height="340" style="position: absolute; left: 0; top: 0;">
              <!-- 2番ピンへ -->
              <line x1="367" y1="99" x2="405" y2="99" stroke="red" stroke-width="3" />
              <line x1="403" y1="99" x2="403" y2="300" stroke="red" stroke-width="3" />
              <line x1="403" y1="299" x2="360" y2="299" stroke="red" stroke-width="3" />
              <line x1="360" y1="299" x2="345" y2="310" stroke="red" stroke-width="3" />
              <!-- 3番ピンへ -->
              <line x1="381" y1="84" x2="420" y2="84" stroke="red" stroke-width="3" />
              <line x1="418" y1="84" x2="418" y2="295" stroke="red" stroke-width="3" />
              <line x1="418" y1="293" x2="406" y2="293" stroke="red" stroke-width="3" />
              <line x1="400" y1="293" x2="360" y2="293" stroke="red" stroke-width="3" />
              <line x1="360" y1="293" x2="335" y2="310" stroke="red" stroke-width="3" />
              <!-- 4番ピンへ -->
              <line x1="368" y1="209" x2="392" y2="209" stroke="red" stroke-width="3" />
              <line x1="390" y1="209" x2="390" y2="286" stroke="red" stroke-width="3" />
              <line x1="392" y1="286" x2="360" y2="286" stroke="red" stroke-width="3" />
              <line x1="360" y1="286" x2="325" y2="310" stroke="red" stroke-width="3" />
              <!-- 5番ピンへ -->
              <line x1="233" y1="179" x2="225" y2="179" stroke="red" stroke-width="3" />
              <line x1="227" y1="179" x2="227" y2="218" stroke="red" stroke-width="3" />
              <line x1="227" y1="231" x2="227" y2="240" stroke="red" stroke-width="3" />
              <line x1="225" y1="240" x2="320" y2="240" stroke="red" stroke-width="3" />
              <line x1="318" y1="240" x2="318" y2="310" stroke="red" stroke-width="3" />
              <!-- 6番ピンへ -->
              <line x1="203" y1="209" x2="193" y2="209" stroke="red" stroke-width="3" />
              <line x1="195" y1="209" x2="195" y2="260" stroke="red" stroke-width="3" />
              <line x1="193" y1="260" x2="310" y2="260" stroke="red" stroke-width="3" />
              <line x1="308" y1="260" x2="308" y2="310" stroke="red" stroke-width="3" />
              <!-- 7番ピンへ -->
              <line x1="218" y1="99" x2="180" y2="99" stroke="red" stroke-width="3" />
              <line x1="182" y1="99" x2="182" y2="270" stroke="red" stroke-width="3" />
              <line x1="180" y1="270" x2="300" y2="270" stroke="red" stroke-width="3" />
              <line x1="298" y1="270" x2="298" y2="310" stroke="red" stroke-width="3" />
              <!-- 8番ピンへ -->
              <line x1="203" y1="84" x2="165" y2="84" stroke="red" stroke-width="3" />
              <line x1="167" y1="84" x2="167" y2="280" stroke="red" stroke-width="3" />
              <line x1="165" y1="280" x2="286" y2="280" stroke="red" stroke-width="3" />
              <line x1="284" y1="280" x2="284" y2="310" stroke="red" stroke-width="3" />
              <!-- GNDへ -->
              <line x1="292" y1="84" x2="292" y2="40" stroke="black" stroke-width="3" />
              <line x1="292" y1="40" x2="150" y2="40" stroke="black" stroke-width="3" />
              <line x1="152" y1="40" x2="152" y2="295" stroke="black" stroke-width="3" />
              <line x1="150" y1="295" x2="228" y2="295" stroke="black" stroke-width="3" />
              <line x1="226" y1="295" x2="225" y2="310" stroke="black" stroke-width="3" />
            </svg>
          </div>
          <p></p>
          <div class="toolbar">
            <button id="run-button2">Run</button>
            <button id="stop-button2" disabled>Stop</button>
            <div class="spacer"></div>
            <div id="status-label2"></div>
          </div>
          <div class="code-editor" id="editor2"></div>
          <div class="compiler-output">
            <pre id="compiler-output-text2"></pre>
          </div>
          <div class="error-output">
            <pre id="error-output-text2"></pre>
          </div>
          <div id="result"></div>
        </div>
        <button class="page-nav" data-to="page2" data-editor="#editor1" data-run="run-button1" data-stop="stop-button1"
          data-status="status-label1" data-compiler="compiler-output-text1"
          data-error="error-output-text1">前のページへ</button>
        <button class="page-nav" data-to="pageTest" data-editor="#editor3" data-run="run-button3"
          data-stop="stop-button3" data-status="status-label3" data-compiler="compiler-output-text3"
          data-error="error-output-text3" id="toTestfrom3" style="display:none;"
          onclick="markPageReached(3);">次のページへ</button>
        <script>
          let seg = document.querySelector('wokwi-7segment[id="segment"]');
          const segAns = [1, 0, 1, 1, 0, 1, 1, 0];

          setInterval(() => {
            if (JSON.stringify(seg.values) === JSON.stringify(segAns)) {
              console.log("全問正解です！次のページへ行きましょう！", seg.values);
              document.getElementById('result').innerHTML = "<b>正解です！確認問題へ行きましょう！</b>";
              document.getElementById('result').style.color = "green";
              document.getElementById('toTestfrom3').style.display = 'inline';
            }
          }, 100);

        </script>
      </div>
      <div id="pageTest" style="display:none;">
        <h2>確認問題</h2>
        <h2>問題を回答し、「回答チェック」ボタンを押して正解かどうか確認しましょう。<br>プログラムを作成する問題はプログラムを実行することで正解かどうか確認できます。</h2>

        <h3>1. それぞれについて、正しい説明を1つ選んでください。</h3>
        <p><b>Q1. 7セグメントLEDの構成として正しいものはどれですか？</b></p>
        <form name="q1">
          <div class="form-row">
            <input type="radio" name="q1" value="1">
            <label></label>7つのLEDだけで構成される</label>
          </div>
          <div class="form-row">
            <input type="radio" name="q1" value="2">
            <label>7つの棒状LEDと1つの点の計8個で構成される</label>
          </div>
          <div class="form-row">
            <input type="radio" name="q1" value="3">
            <label>8つの棒状LEDと1つの点の計9個で構成される</label>
          </div>
        </form>
        <p><b>Q2. 7セグメントLEDが点灯する仕組みとして正しいものはどれですか？(カソードコモン型)</b></p>
        <form name="q2">
          <div class="form-row">
            <input type="radio" name="q2" value="1">
            <label></label>ピンに電圧がかかると7セグメントLED全体が一度に点灯する</label>
          </div>
          <div class="form-row">
            <input type="radio" name="q2" value="2">
            <label>各セグメントは共通のピンで制御される</label>
          </div>
          <div class="form-row">
            <input type="radio" name="q2" value="3">
            <label>各LEDに対応するピンへ電流を流すことで点灯する</label>
          </div>
        </form>
        <p><b>Q3. アノードコモン型・カソードコモン型の説明として正しいものはどれですか？</b></p>
        <form name="q3">
          <div class="form-row">
            <input type="radio" name="q3" value="1">
            <label>アノード側がまとめられているものがカソードコモン型</label>
          </div>
          <div class="form-row">
            <input type="radio" name="q3" value="2">
            <label>カソード側がまとめられているものがカソードコモン型</label>
          </div>
          <div class="form-row">
            <input type="radio" name="q3" value="3">
            <label>どちらもすべてのピンが独立している</label>
          </div>
        </form>
        <p><b>Q4. カソードコモン型7セグメントLEDをArduinoで制御するときの接続として正しいものはどれですか？
          </b></p>
        <form name="q4">
          <div class="form-row">
            <input type="radio" name="q4" value="1">
            <label>アノード側ピン（1～8）を入力ピンに接続し、共通端子をGNDに接続する</label>
          </div>
          <div class="form-row">
            <input type="radio" name="q4" value="2">
            <label>アノード側ピン（1～8）を出力ピンに接続し、共通端子をGNDに接続する</label>
          </div>
          <div class="form-row">
            <input type="radio" name="q4" value="3">
            <label>アノード側ピン（1～8）をGNDに接続し、共通端子を出力ピンに接続する</label>
          </div>
        </form>
        <button id="check-answer-btn" onclick="checkAnswer()">回答チェック</button>
        <div id="result1" style="margin-top: 20px;"></div>

        <h3>２．7セグメントLEDに3を表示するプログラムを作成してください。</h3>
        <div class="app-container">
          <div class="leds-circuit" style="position: relative; width: 500px; height: 500px; margin: 0 auto;">
            <my-breadboard style="display:block; position:absolute; top:0px; left:0px;"></my-breadboard>
            <!-- LEDを中央上に配置 -->
            <wokwi-7segment id="segment" color="red" values="[0,0,0,0,0,0,0,0]" pins="extend"
              style="position: absolute; left: 269px; top: 111px; transform: scale(1.56, 1.28);"></wokwi-7segment>
            <!-- Arduino Unoを中央下に配置 -->
            <wokwi-resistor value="200" style="position: absolute; left: 308px; top: 219px;"></wokwi-resistor>
            <wokwi-resistor value="200"
              style="position: absolute; left: 225px; top: 203px; transform: rotate(212deg);"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 203px; top: 219px;"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 308px; top: 79px;"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 323px; top: 64px;"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 218px; top: 79px;"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 203px; top: 64px;"></wokwi-resistor>


            <wokwi-arduino-uno id="circuit-arduino"
              style="position: absolute; left: 110px; top: 300px;"></wokwi-arduino-uno>
            <!-- 回路の線をSVGで描画（LEDの足からArduinoの7番ピン/GNDへ） -->
            <svg width="500" height="340" style="position: absolute; left: 0; top: 0;">
              <!-- 2番ピンへ -->
              <line x1="367" y1="99" x2="405" y2="99" stroke="red" stroke-width="3" />
              <line x1="403" y1="99" x2="403" y2="300" stroke="red" stroke-width="3" />
              <line x1="403" y1="299" x2="360" y2="299" stroke="red" stroke-width="3" />
              <line x1="360" y1="299" x2="345" y2="310" stroke="red" stroke-width="3" />
              <!-- 3番ピンへ -->
              <line x1="381" y1="84" x2="420" y2="84" stroke="red" stroke-width="3" />
              <line x1="418" y1="84" x2="418" y2="295" stroke="red" stroke-width="3" />
              <line x1="418" y1="293" x2="406" y2="293" stroke="red" stroke-width="3" />
              <line x1="400" y1="293" x2="360" y2="293" stroke="red" stroke-width="3" />
              <line x1="360" y1="293" x2="335" y2="310" stroke="red" stroke-width="3" />
              <!-- 4番ピンへ -->
              <line x1="368" y1="209" x2="392" y2="209" stroke="red" stroke-width="3" />
              <line x1="390" y1="209" x2="390" y2="286" stroke="red" stroke-width="3" />
              <line x1="392" y1="286" x2="360" y2="286" stroke="red" stroke-width="3" />
              <line x1="360" y1="286" x2="325" y2="310" stroke="red" stroke-width="3" />
              <!-- 5番ピンへ -->
              <line x1="233" y1="179" x2="225" y2="179" stroke="red" stroke-width="3" />
              <line x1="227" y1="179" x2="227" y2="218" stroke="red" stroke-width="3" />
              <line x1="227" y1="231" x2="227" y2="240" stroke="red" stroke-width="3" />
              <line x1="225" y1="240" x2="320" y2="240" stroke="red" stroke-width="3" />
              <line x1="318" y1="240" x2="318" y2="310" stroke="red" stroke-width="3" />
              <!-- 6番ピンへ -->
              <line x1="203" y1="209" x2="193" y2="209" stroke="red" stroke-width="3" />
              <line x1="195" y1="209" x2="195" y2="260" stroke="red" stroke-width="3" />
              <line x1="193" y1="260" x2="310" y2="260" stroke="red" stroke-width="3" />
              <line x1="308" y1="260" x2="308" y2="310" stroke="red" stroke-width="3" />
              <!-- 7番ピンへ -->
              <line x1="218" y1="99" x2="180" y2="99" stroke="red" stroke-width="3" />
              <line x1="182" y1="99" x2="182" y2="270" stroke="red" stroke-width="3" />
              <line x1="180" y1="270" x2="300" y2="270" stroke="red" stroke-width="3" />
              <line x1="298" y1="270" x2="298" y2="310" stroke="red" stroke-width="3" />
              <!-- 8番ピンへ -->
              <line x1="203" y1="84" x2="165" y2="84" stroke="red" stroke-width="3" />
              <line x1="167" y1="84" x2="167" y2="280" stroke="red" stroke-width="3" />
              <line x1="165" y1="280" x2="286" y2="280" stroke="red" stroke-width="3" />
              <line x1="284" y1="280" x2="284" y2="310" stroke="red" stroke-width="3" />
              <!-- GNDへ -->
              <line x1="292" y1="84" x2="292" y2="40" stroke="black" stroke-width="3" />
              <line x1="292" y1="40" x2="150" y2="40" stroke="black" stroke-width="3" />
              <line x1="152" y1="40" x2="152" y2="295" stroke="black" stroke-width="3" />
              <line x1="150" y1="295" x2="228" y2="295" stroke="black" stroke-width="3" />
              <line x1="226" y1="295" x2="225" y2="310" stroke="black" stroke-width="3" />
            </svg>
          </div>
          <p></p>
          <div class="toolbar">
            <button id="run-button3">Run</button>
            <button id="stop-button3" disabled>Stop</button>
            <div class="spacer"></div>
            <div id="status-label3"></div>
          </div>
          <div class="code-editor" id="editor3"></div>
          <div class="compiler-output">
            <pre id="compiler-output-text3"></pre>
          </div>
          <div class="error-output">
            <pre id="error-output-text3"></pre>
          </div>
        </div>
        <div id="result2"></div>
        <div id="result3"></div>


        <button class="page-nav" data-to="page3" data-editor="#editor2" data-run="run-button2" data-stop="stop-button2"
          data-status="status-label2" data-compiler="compiler-output-text2"
          data-error="error-output-text2">前のページへ</button>
        <button class="page-nav" data-to="pageOmake" data-editor="#editor4" data-run="run-button4"
          data-stop="stop-button4" data-status="status-label4" data-compiler="compiler-output-text4"
          data-error="error-output-text4" style="display:none;" id="pageOmake"
          onclick="markPageReached(4);">次のページへ</button>
        <script>
          seg = document.querySelector('wokwi-7segment[id="segment"]');
          const segAns1 = [1, 1, 1, 1, 0, 0, 1, 0];
          let que1 = false;
          let que2 = false;

          function checkAnswer() {
            // 各問題の正解インデックス（0始まり）
            const correct = {
              q1: [1], // Q1は2番目（index:1）が正解
              q2: [2], // Q2は3番目（index:2）が正解
              q3: [1], // Q3は3番目（index:2）が正解
              q4: [1], // Q4は3番目（index:2）が正解
            };

            let results = [];
            Object.keys(correct).forEach(q => {
              const form = document.forms[q];
              const checks = Array.from(form.querySelectorAll('input[type="radio"]'));
              const checkedIdx = checks.findIndex(c => c.checked); // 選択されたインデックス（1つだけ）
              const isCorrect = JSON.stringify([checkedIdx]) === JSON.stringify(correct[q]);
              results.push(isCorrect ? "○" : "×");
            });

            // 全問分の結果をresult1に表示
            // 横並びで表示
            let html = '';
            Object.keys(correct).forEach((q, i) => {
              html += `Q${i + 1}:${results[i]} `;
            });
            html = html.trim();
            if (results.every(r => r === "○")) {
              html += '<br><span style="color:green;font-weight:bold;">全問正解です！</span>';
              que1 = true;
            } else {
              html += '<br><span style="color:red;font-weight:bold;">不正解の問題があります。もう一度確認してみましょう。</span>';
            }
            document.getElementById('result1').innerHTML = html;
          }

          setInterval(() => {
            if (JSON.stringify(seg.values) === JSON.stringify(segAns1)) {
              document.getElementById('result2').innerHTML = "<br><span style=\"color:green;font-weight:bold;\">正解です！</span>";
              que2 = true;
            }
            if (que1 && que2) {
              document.getElementById('result3').innerHTML = "<br><span style=\"color:green;font-weight:bold;\">全問正解です！次のページへ行きましょう！</span>";
              document.getElementById('pageOmake').style.display = 'inline';
            }
          }, 100);
        </script>
      </div>
      <div id="pageOmake" style="display:none;">
        <h2>3章おまけ：繰り返し処理</h2>
        <div class="orange-point-box">
          <p style="font-size:1.1em;"><b>3章では、7セグメントLEDを制御するために8本のピンを使用しました。</b></p>
          <p>これまでは、各ピンごとに１行ずつプログラムを書いて設定していましたが、<span
              style="background:#ffe0b2; padding:2px 6px; border-radius:4px;"><b>繰り返し処理</b></span>を使うことで、同じような処理をまとめて書くことができ、コードを短くすることができます。
          </p>
          <div style="background:#e3f2fd; border-left:4px solid #1976d2; padding:8px 12px; margin:12px 0;">
            <h3>繰り返し処理</h3>
            <b>繰り返し処理を行うときには <span style="color:#d84315;">for文</span> を使います。</b><br>
            for文を使うときは、以下のように記述します。
            <pre
              style="background:#f0f7ff; border-radius:4px; padding:8px; margin-top:8px;"><code>for (初期化; 条件式; 更新処理) {繰り返し中に行う処理;}</code></pre>
            <p style="margin-top:8px;">for文は「<b>初期化 → 条件判定 → 処理 → 更新</b>」を自動で繰り返してくれる構文です。</p>
          </div>
          <div style="background:#fffde7; border-left:4px solid #ffeb3b; padding:8px 12px; margin:12px 0;">
            <b>実際に2～9番ピンをまとめて出力に設定する例</b>
            <pre
              style="background:#fffde7; border-radius:4px; padding:8px; margin-top:8px;"><code>for (int i = 2; i &lt; 10; i++) {pinMode(i, OUTPUT);}</code></pre>
            <ul style="margin-top:10px;">
              <li><code>int i = 2;</code> …… <b>最初に i を 2 にする（スタート）</b></li>
              <li><code>i &lt; 10;</code> …… <b>i が 10 より小さい間（2～9の間）繰り返す</b></li>
              <li><code>i++;</code> …… <b>繰り返すたびに i の値を1増やす</b></li>
            </ul>
          </div>
          <p style="margin-top:12px;">このようにfor文を使うことで、7セグメントLEDのように複数のピンをまとめて設定するコードを、<span
              style="color:#d84315; font-weight:bold;">短くわかりやすく</span>書くことができます。</p>
        </div>
        <p>以下のプログラムは実際に繰り返し処理を用いて7セグメントLEDを制御した例です。</p>
        <div class="app-container">
          <div class="leds-circuit" style="position: relative; width: 500px; height: 500px; margin: 0 auto;">
            <my-breadboard style="display:block; position:absolute; top:0px; left:0px;"></my-breadboard>
            <!-- LEDを中央上に配置 -->
            <wokwi-7segment id="segment" color="red" values="[0,0,0,0,0,0,0,0]" pins="extend"
              style="position: absolute; left: 269px; top: 111px; transform: scale(1.56, 1.28);"></wokwi-7segment>
            <!-- Arduino Unoを中央下に配置 -->
            <wokwi-resistor value="200" style="position: absolute; left: 308px; top: 219px;"></wokwi-resistor>
            <wokwi-resistor value="200"
              style="position: absolute; left: 225px; top: 203px; transform: rotate(212deg);"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 203px; top: 219px;"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 308px; top: 79px;"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 323px; top: 64px;"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 218px; top: 79px;"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 203px; top: 64px;"></wokwi-resistor>


            <wokwi-arduino-uno id="circuit-arduino"
              style="position: absolute; left: 110px; top: 300px;"></wokwi-arduino-uno>
            <!-- 回路の線をSVGで描画（LEDの足からArduinoの7番ピン/GNDへ） -->
            <svg width="500" height="340" style="position: absolute; left: 0; top: 0;">
              <!-- 2番ピンへ -->
              <line x1="367" y1="99" x2="405" y2="99" stroke="red" stroke-width="3" />
              <line x1="403" y1="99" x2="403" y2="300" stroke="red" stroke-width="3" />
              <line x1="403" y1="299" x2="360" y2="299" stroke="red" stroke-width="3" />
              <line x1="360" y1="299" x2="345" y2="310" stroke="red" stroke-width="3" />
              <!-- 3番ピンへ -->
              <line x1="381" y1="84" x2="420" y2="84" stroke="red" stroke-width="3" />
              <line x1="418" y1="84" x2="418" y2="295" stroke="red" stroke-width="3" />
              <line x1="418" y1="293" x2="406" y2="293" stroke="red" stroke-width="3" />
              <line x1="400" y1="293" x2="360" y2="293" stroke="red" stroke-width="3" />
              <line x1="360" y1="293" x2="335" y2="310" stroke="red" stroke-width="3" />
              <!-- 4番ピンへ -->
              <line x1="368" y1="209" x2="392" y2="209" stroke="red" stroke-width="3" />
              <line x1="390" y1="209" x2="390" y2="286" stroke="red" stroke-width="3" />
              <line x1="392" y1="286" x2="360" y2="286" stroke="red" stroke-width="3" />
              <line x1="360" y1="286" x2="325" y2="310" stroke="red" stroke-width="3" />
              <!-- 5番ピンへ -->
              <line x1="233" y1="179" x2="225" y2="179" stroke="red" stroke-width="3" />
              <line x1="227" y1="179" x2="227" y2="218" stroke="red" stroke-width="3" />
              <line x1="227" y1="231" x2="227" y2="240" stroke="red" stroke-width="3" />
              <line x1="225" y1="240" x2="320" y2="240" stroke="red" stroke-width="3" />
              <line x1="318" y1="240" x2="318" y2="310" stroke="red" stroke-width="3" />
              <!-- 6番ピンへ -->
              <line x1="203" y1="209" x2="193" y2="209" stroke="red" stroke-width="3" />
              <line x1="195" y1="209" x2="195" y2="260" stroke="red" stroke-width="3" />
              <line x1="193" y1="260" x2="310" y2="260" stroke="red" stroke-width="3" />
              <line x1="308" y1="260" x2="308" y2="310" stroke="red" stroke-width="3" />
              <!-- 7番ピンへ -->
              <line x1="218" y1="99" x2="180" y2="99" stroke="red" stroke-width="3" />
              <line x1="182" y1="99" x2="182" y2="270" stroke="red" stroke-width="3" />
              <line x1="180" y1="270" x2="300" y2="270" stroke="red" stroke-width="3" />
              <line x1="298" y1="270" x2="298" y2="310" stroke="red" stroke-width="3" />
              <!-- 8番ピンへ -->
              <line x1="203" y1="84" x2="165" y2="84" stroke="red" stroke-width="3" />
              <line x1="167" y1="84" x2="167" y2="280" stroke="red" stroke-width="3" />
              <line x1="165" y1="280" x2="286" y2="280" stroke="red" stroke-width="3" />
              <line x1="284" y1="280" x2="284" y2="310" stroke="red" stroke-width="3" />
              <!-- GNDへ -->
              <line x1="292" y1="84" x2="292" y2="40" stroke="black" stroke-width="3" />
              <line x1="292" y1="40" x2="150" y2="40" stroke="black" stroke-width="3" />
              <line x1="152" y1="40" x2="152" y2="295" stroke="black" stroke-width="3" />
              <line x1="150" y1="295" x2="228" y2="295" stroke="black" stroke-width="3" />
              <line x1="226" y1="295" x2="225" y2="310" stroke="black" stroke-width="3" />
            </svg>
          </div>
          <p></p>
          <div class="toolbar">
            <button id="run-button4">Run</button>
            <button id="stop-button4" disabled>Stop</button>
            <div class="spacer"></div>
            <div id="status-label4"></div>
          </div>
          <div class="code-editor" id="editor4"></div>
          <div class="compiler-output">
            <pre id="compiler-output-text4"></pre>
          </div>
          <div class="error-output">
            <pre id="error-output-text4"></pre>
          </div>
        </div>
        <button class="page-nav" data-to="pageTest" data-editor="#editor3" data-run="run-button3"
          data-stop="stop-button3" data-status="status-label3" data-compiler="compiler-output-text3"
          data-error="error-output-text3">前のページへ</button>
        <button class="page-nav" data-to="pageOmake2" data-editor="#editor5" data-run="run-button5"
          data-stop="stop-button5" data-status="status-label5" data-compiler="compiler-output-text5"
          data-error="error-output-text5" onclick="markPageReached(5);">次のページへ</button>
      </div>
      <div id="pageOmake2" style="display:none;">
        <h2>３章おまけ２：配列(Array)</h2>
        <p>前のページでは、繰り返し処理（for文）を使うことで、同じ処理を短く書けることを学びました。</p>
        <p>LEDの点灯の処理を行う際にも、<b>配列</b>という機能と、繰り返し処理を使うことで、コードを短くすることができます。</p>
        <div class="blue-point-box">
          <p><b>複数のピンをまとめて管理したいときは、<span style="color:#1976d2;">配列（Array）</span>が便利です。</b></p>
          <ul style="margin-top:10px;">
            <li>ピン番号をひとまとめにできる</li>
            <li>for文と組み合わせて、初期設定や点灯処理を簡単に記述できる</li>
            <li>後からピン番号を変更したい場合も、配列の中身だけ変えればOK</li>
          </ul>
          <div style="background:#bcecbf; border-left:4px solid #388e3c; padding:8px 12px; margin:12px 0;">
            <b>配列の宣言例</b>
            <pre
              style="background:#f6fff6; border-radius:4px; padding:8px; margin-top:8px;"><code>int segPins[8] = {2, 3, 4, 5, 6, 7, 8, 9};</code></pre>
            <p style="margin-top:8px;">例：<code>segPins[0]</code>はピン2、<code>segPins[1]</code>はピン3…というようにアクセスできます。</p>
          </div>
          <div style="background:#e3f2fd; border-left:4px solid #1976d2; padding:8px 12px; margin:12px 0;">
            <b>for文と組み合わせた出力設定</b>
            <pre style="background:#f0f7ff; border-radius:4px; padding:8px; margin-top:8px;"><code>for (int i = 0; i &lt; 8; i++) {
        digitalWrite(segPins[i], HIGH);
    }</code></pre>
            <p style="margin-top:8px;">配列の各ピン番号を順番に取り出して、すべてOUTPUTに設定できます。</p>
          </div>
          <p style="margin-top:12px;">配列を使うことで、コードが短く・管理しやすくなります。</p>
        </div>
        <p>以下のプログラムは実際に繰り返し処理と配列を用いて7セグメントLEDを制御した例です。</p>
        <div class="app-container">
          <div class="leds-circuit" style="position: relative; width: 500px; height: 500px; margin: 0 auto;">
            <my-breadboard style="display:block; position:absolute; top:0px; left:0px;"></my-breadboard>
            <!-- LEDを中央上に配置 -->
            <wokwi-7segment id="segment" color="red" values="[0,0,0,0,0,0,0,0]" pins="extend"
              style="position: absolute; left: 269px; top: 111px; transform: scale(1.56, 1.28);"></wokwi-7segment>
            <!-- Arduino Unoを中央下に配置 -->
            <wokwi-resistor value="200" style="position: absolute; left: 308px; top: 219px;"></wokwi-resistor>
            <wokwi-resistor value="200"
              style="position: absolute; left: 225px; top: 203px; transform: rotate(212deg);"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 203px; top: 219px;"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 308px; top: 79px;"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 323px; top: 64px;"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 218px; top: 79px;"></wokwi-resistor>
            <wokwi-resistor value="200" style="position: absolute; left: 203px; top: 64px;"></wokwi-resistor>


            <wokwi-arduino-uno id="circuit-arduino"
              style="position: absolute; left: 110px; top: 300px;"></wokwi-arduino-uno>
            <!-- 回路の線をSVGで描画（LEDの足からArduinoの7番ピン/GNDへ） -->
            <svg width="500" height="340" style="position: absolute; left: 0; top: 0;">
              <!-- 2番ピンへ -->
              <line x1="367" y1="99" x2="405" y2="99" stroke="red" stroke-width="3" />
              <line x1="403" y1="99" x2="403" y2="300" stroke="red" stroke-width="3" />
              <line x1="403" y1="299" x2="360" y2="299" stroke="red" stroke-width="3" />
              <line x1="360" y1="299" x2="345" y2="310" stroke="red" stroke-width="3" />
              <!-- 3番ピンへ -->
              <line x1="381" y1="84" x2="420" y2="84" stroke="red" stroke-width="3" />
              <line x1="418" y1="84" x2="418" y2="295" stroke="red" stroke-width="3" />
              <line x1="418" y1="293" x2="406" y2="293" stroke="red" stroke-width="3" />
              <line x1="400" y1="293" x2="360" y2="293" stroke="red" stroke-width="3" />
              <line x1="360" y1="293" x2="335" y2="310" stroke="red" stroke-width="3" />
              <!-- 4番ピンへ -->
              <line x1="368" y1="209" x2="392" y2="209" stroke="red" stroke-width="3" />
              <line x1="390" y1="209" x2="390" y2="286" stroke="red" stroke-width="3" />
              <line x1="392" y1="286" x2="360" y2="286" stroke="red" stroke-width="3" />
              <line x1="360" y1="286" x2="325" y2="310" stroke="red" stroke-width="3" />
              <!-- 5番ピンへ -->
              <line x1="233" y1="179" x2="225" y2="179" stroke="red" stroke-width="3" />
              <line x1="227" y1="179" x2="227" y2="218" stroke="red" stroke-width="3" />
              <line x1="227" y1="231" x2="227" y2="240" stroke="red" stroke-width="3" />
              <line x1="225" y1="240" x2="320" y2="240" stroke="red" stroke-width="3" />
              <line x1="318" y1="240" x2="318" y2="310" stroke="red" stroke-width="3" />
              <!-- 6番ピンへ -->
              <line x1="203" y1="209" x2="193" y2="209" stroke="red" stroke-width="3" />
              <line x1="195" y1="209" x2="195" y2="260" stroke="red" stroke-width="3" />
              <line x1="193" y1="260" x2="310" y2="260" stroke="red" stroke-width="3" />
              <line x1="308" y1="260" x2="308" y2="310" stroke="red" stroke-width="3" />
              <!-- 7番ピンへ -->
              <line x1="218" y1="99" x2="180" y2="99" stroke="red" stroke-width="3" />
              <line x1="182" y1="99" x2="182" y2="270" stroke="red" stroke-width="3" />
              <line x1="180" y1="270" x2="300" y2="270" stroke="red" stroke-width="3" />
              <line x1="298" y1="270" x2="298" y2="310" stroke="red" stroke-width="3" />
              <!-- 8番ピンへ -->
              <line x1="203" y1="84" x2="165" y2="84" stroke="red" stroke-width="3" />
              <line x1="167" y1="84" x2="167" y2="280" stroke="red" stroke-width="3" />
              <line x1="165" y1="280" x2="286" y2="280" stroke="red" stroke-width="3" />
              <line x1="284" y1="280" x2="284" y2="310" stroke="red" stroke-width="3" />
              <!-- GNDへ -->
              <line x1="292" y1="84" x2="292" y2="40" stroke="black" stroke-width="3" />
              <line x1="292" y1="40" x2="150" y2="40" stroke="black" stroke-width="3" />
              <line x1="152" y1="40" x2="152" y2="295" stroke="black" stroke-width="3" />
              <line x1="150" y1="295" x2="228" y2="295" stroke="black" stroke-width="3" />
              <line x1="226" y1="295" x2="225" y2="310" stroke="black" stroke-width="3" />
            </svg>
          </div>
          <p></p>
          <div class="toolbar">
            <button id="run-button5">Run</button>
            <button id="stop-button5" disabled>Stop</button>
            <div class="spacer"></div>
            <div id="status-label5"></div>
          </div>
          <div class="code-editor" id="editor5"></div>
          <div class="compiler-output">
            <pre id="compiler-output-text5"></pre>
          </div>
          <div class="error-output">
            <pre id="error-output-text5"></pre>
          </div>
        </div>
        <p>配列と繰り返し処理を用いることで、3章のプログラムを短くすることが出来ました。</p>
        <button class="page-nav" data-to="pageTest" data-editor="#editor4" data-run="run-button4"
          data-stop="stop-button4" data-status="status-label4" data-compiler="compiler-output-text4"
          data-error="error-output-text4">前のページへ</button>
        <button id="tochap4-btn" onclick="window.location.href='que4.html'">次の章へ</button>
      </div>
    </div>
    <div class="sidebar"></div>
  </div>
</body>
<script>
  let selected_editor = '#editor1';
  const readOnly = false;

  document.addEventListener('DOMContentLoaded', function () {
    // ページコード全体をローカルストレージから復元
    const codesAll = localStorage.getItem('page3_codes_all');
    if (codesAll) {
      try {
        const parsed = JSON.parse(codesAll);
        if (parsed && typeof parsed === 'object') {
          Object.keys(PAGE_CODES).forEach(key => {
            if (parsed[key]) PAGE_CODES[key] = parsed[key];
          });
        }
      } catch (e) { }
    }

    // 各Runボタンにイベント登録
    const pageKeys = ['page1', 'page3', 'pageTest', 'pageOmake', 'pageOmake2'];
    ['run-button1', 'run-button2', 'run-button3', 'run-button4', 'run-button5'].forEach((btnId, idx) => {
      const btn = document.getElementById(btnId);
      if (btn) {
        btn.addEventListener('click', function () {
          // 現在のエディタのコードを取得して保存
          let code = editor.getModel().getValue();
          PAGE_CODES[pageKeys[idx]] = code;
          // ローカルストレージに保存
          localStorage.setItem('page3_codes_all', JSON.stringify(PAGE_CODES));
          console.log(code);
        });
      }
    });
  });
  // ページ到達状況を管理（例：最初のページだけ到達済み）
  let reachedPages3 = JSON.parse(localStorage.getItem('reachedPages3')) || [true, false, false, false, false, false, false];
  // ページリンクを取得
  const pageLinks = document.querySelectorAll('.sidebar-links .page-link');
  function updateSidebarLinks() {
    console.log('Updating sidebar links with reachedPages3:', reachedPages3);
    pageLinks.forEach((link, idx) => {
      link.style.display = reachedPages3[idx] ? 'block' : 'none';
    });
  }
  // ページ到達時に呼び出す
  function markPageReached(pageIdx) {
    reachedPages3[pageIdx] = true;
    localStorage.setItem('reachedPages3', JSON.stringify(reachedPages3));
    updateSidebarLinks();
  }

  // 初期化
  updateSidebarLinks();

  // 共通ページ切り替え関数
  function showPage(toPage, btn) {
    // すべてのページを非表示
    document.querySelectorAll('[id^="page"]').forEach(div => {
      div.style.display = (div.id === toPage) ? 'block' : 'none';
    });
    window.scrollTo(0, 0);
    // エディタやボタンの切り替え
    if (btn) {
      const editor = btn.dataset.editor;
      const run = btn.dataset.run;
      const stop = btn.dataset.stop;
      const status = btn.dataset.status;
      const compiler = btn.dataset.compiler;
      const error = btn.dataset.error;
      if (editor && run && stop && status && compiler && error) {
        selected_editor = editor;
        window.errorOutputText.textContent = '';
        window.setActiveButtons(run, stop, status, compiler, error);
        window.INITIAL_CODE = PAGE_CODES[toPage] || '';
        window.initMonacoEditor();
      }
    }
  }

  document.addEventListener('DOMContentLoaded', function () {
    window.setActiveButtons('run-button1', 'stop-button1', 'status-label1', 'compiler-output-text1', 'error-output-text1');
    window.INITIAL_CODE = PAGE_CODES['page1'];
    document.querySelectorAll('.page-link, .page-nav').forEach(link => {
      link.addEventListener('click', function (e) {
        e.preventDefault();
        const toPage = this.dataset.to || this.dataset.page;
        showPage(toPage, this);
      });
    });
    window.markChapterUnlocked(3);
    if (!localStorage.getItem('chapter3_start') && !localStorage.getItem('chapter3_time')) {
      localStorage.setItem('chapter3_start', Date.now());
    }
    const chapter2_start = parseInt(localStorage.getItem('chapter2_start'));
    const end = Date.now();
    const diffMs = end - chapter2_start; // 経過ミリ秒
    const diffSec = Math.floor(diffMs / 1000); // 経過秒
    localStorage.setItem('chapter2_time', diffSec);
    localStorage.removeItem('chapter2_start');
  });
  const PAGE_CODES = {
    page1: `
void setup() {
    pinMode(2, OUTPUT);      
    pinMode(3, OUTPUT);   
    pinMode(4, OUTPUT);      
    pinMode(5, OUTPUT);    
    pinMode(6, OUTPUT);      
    pinMode(7, OUTPUT);   
    pinMode(8, OUTPUT);
}
void loop() {
    digitalWrite(2, HIGH);
    digitalWrite(3, HIGH);
    digitalWrite(4, HIGH);
    digitalWrite(5, HIGH);
    digitalWrite(6, HIGH);
    digitalWrite(7, HIGH);
    digitalWrite(8, HIGH);
}
`.trim(),

    page3: `
void setup() {
    pinMode(2, OUTPUT);      
    pinMode(3, OUTPUT);   
    pinMode(4, OUTPUT);      
    pinMode(5, OUTPUT);    
    pinMode(6, OUTPUT);      
    pinMode(7, OUTPUT);   
    pinMode(8, OUTPUT);
}
void loop() {
    digitalWrite(2, LOW); //1
    digitalWrite(3, LOW); //2
    digitalWrite(4, LOW); //3
    digitalWrite(5, LOW); //4
    digitalWrite(6, LOW); //5
    digitalWrite(7, LOW); //6
    digitalWrite(8, LOW); //7
}
`.trim(),
    pageTest: `
void setup() {

}
void loop() {

}
`.trim(),
    pageOmake: `
void setup() {
  for (int i = 2; i < 10; i++) {
    pinMode(i, OUTPUT);
  }
}
void loop() {
    digitalWrite(2, HIGH);
    digitalWrite(3, HIGH);
    digitalWrite(4, HIGH);
    digitalWrite(5, HIGH);
    digitalWrite(6, HIGH);
    digitalWrite(7, HIGH);
    digitalWrite(8, HIGH);
    digitalWrite(9, HIGH);
}
`.trim(),
    pageOmake2: `
void setup() {
  for (int i = 2; i < 10; i++) {
    pinMode(i, OUTPUT);
  }
}
int segPins[8] = {2, 3, 4, 5, 6, 7, 8, 9};
void loop() {
    for (int i = 0; i < 8; i++) {
        digitalWrite(segPins[i], HIGH);
    }
}
`.trim(),
  };

  // ラジオボタンの保存・復元
  document.addEventListener('DOMContentLoaded', function () {
    // 復元
    for (let i = 1; i <= 4; i++) {
      const saved = localStorage.getItem('que3_q' + i);
      if (saved) {
        const selector = `input[type="radio"][name="q${i}"][value="${saved}"]`;
        const radio = document.querySelector(selector);
        if (radio) radio.checked = true;
      }
    }
    // 変更時に保存
    for (let i = 1; i <= 4; i++) {
      document.querySelectorAll(`input[type="radio"][name="q${i}"]`).forEach(radio => {
        radio.addEventListener('change', function () {
          if (this.checked) {
            localStorage.setItem('que3_q' + i, this.value);
          }
        });
      });
    }
  });


</script>
</body>

</html>